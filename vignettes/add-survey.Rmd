---
title: "Add Surveys"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{add-survey}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(taskdesignr)
```

# Introduction

Many experimental tasks require some type of survey. A clear example is a simple demographic form. Our package allows you to easily create questionnaires using Shiny. We provide two functions to do this: `surveyUI()` and `surveyServer()`. To illustrate them in use, we will create a questionnaire from McGowan et al (2021). These questions, build into the taskdesignr package, follow a specific format:

```{r, echo = FALSE}
taskdesignr::teaching_r_questions
```

As seen, this is a tidy data frame, where each row is a unique observation and each column has a unique variable. While there are 54 rows, there are only 11 unique questions:

```{r display unique questions}
unique(taskdesignr::teaching_r_questions$question)
```

For simplicity, let's focus on the first question, "What's your age?":

```{r what is your age preview, echo = FALSE}
taskdesignr::teaching_r_questions %>%
  dplyr::filter(input_id == "age")
```

This row shows us that the question is "What's your age?". We know we are expecting a numeric input by looking at the `input_type` column, and the default value is equal to 25 according to the `option` column. It is important to note that the `option` column for numeric inputs provides the default value, but for other types -- as we will see -- provides the possible options for a question. We can also tell that there are no dependency questions. This means that no matter what value you enter, no follow-up question will appear. Lastly, we know this is a required question.



The reason for this is because each question may have many possible options. For example, the first question, "What's your age?", only has one row because there is only one possible input (a number). In contrast, the question "What was your first language?" contains `r teaching_r_questions %>% dplyr::filter(question == "What was your first language?") %>% dplyr::count()` rows because there are that many options to choose from:

```{r show first language options}
taskdesignr::teaching_r_questions %>%
  dplyr::filter(question == "What was your first language?") %>%
  dplyr::pull(option)
```

Note the presence of the NA in the output above. This deals with question dependencies. We will revisit this idea below.

# Basic Survey in Shiny

We assume that you are familiar with the basic layout of a Shiny application. If not, please check out RStudio's [great resources](https://shiny.rstudio.com/tutorial/) before completing this vignette. As an example, we will be using a questionnaire from

<!-- One of the reasons we created this package is to easily combine the questionnaire data with participants' responses. Built in to our package, we provide an example of a participant questionnaire from McGowan et al. (2021) and show how to integrate it into you behavioral task. -->

To begin, install our package:

```{r setup, eval = FALSE}
devtools::install_github("jdtrat/taskdesignr")
library(taskdesignr)
```

The questionnaire we will use today contains eleven unique questions:

```{r display teaching_r_questions}
unique(teaching_r_questions$question)
```

<!-- The final result of your survey will look something  -->

<!-- As you can see, there are some questions that clearly depend on others (numbers 7, 9, and 11).  -->
